<!DOCTYPE html>
<html lang="en-US">
  <head>
    <title>Web Chat: Full-featured bundle</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!--
      This CDN points to the latest official release of Web Chat. If you need to test against Web Chat's latest bits, please refer to pointing to Web Chat's MyGet feed:
      https://github.com/microsoft/BotFramework-WebChat#how-to-test-with-web-chats-latest-bits
    -->
    <!-- <script src="https://cdn.botframework.com/botframework-webchat/latest/webchat.js"></script> -->
    <script src="/webchat.js"></script>
    <style>
      html,
      body {
        height: 100%;
      }

      body {
        margin: 0;
      }

      #webchat {
        height: 100%;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="webchat" role="main"></div>
    <script>
      (async function() {
        // In this demo, we are using Direct Line token from MockBot.
        // Your client code must provide either a secret or a token to talk to your bot.
        // Tokens are more secure. To learn about the differences between secrets and tokens
        // and to understand the risks associated with using secrets, visit https://docs.microsoft.com/en-us/azure/bot-service/rest-api/bot-framework-rest-direct-line-3-0-authentication?view=azure-bot-service-4.0

        const res = await fetch('https://webchat-mockbot.azurewebsites.net/directline/token', { method: 'POST' });
        const { token } = await res.json();
        const store = window.WebChat.createStore({}, () => next => action => {
          console.log(action);
          return next(action);
        });

        window.WebChat.renderWebChat(
          {
            directLine: window.WebChat.createDirectLine({ token }),
            store
          },
          document.getElementById('webchat')
        );

        store.dispatch({
          type: 'WEB_CHAT/SET_NOTIFICATION',
          payload: {
            id: 'connectivity',
            message: 'Connecting...',
            persistent: true
          }
        });

        store.dispatch({
          type: 'WEB_CHAT/SET_NOTIFICATION',
          payload: {
            id: 'privacypolicy',
            level: 'info',
            message:
              'Please read our privacy policy. Quis id qui id consequat enim anim laboris proident. Et veniam qui ea consequat cillum ea nisi anim adipisicing quis aliqua ipsum. Elit cillum Lorem excepteur proident ad. Consequat eiusmod ex sit ex do irure ullamco nostrud. Eu incididunt esse consequat in id fugiat deserunt ipsum irure. In sint exercitation amet non cillum pariatur ex amet. Lorem qui est Lorem tempor velit exercitation consectetur adipisicing pariatur enim commodo nostrud. Aliquip pariatur ad deserunt dolore pariatur pariatur dolore duis. Est nisi incididunt aute est duis do ullamco enim eiusmod velit occaecat deserunt incididunt dolor.',
            persistent: false
          }
        });

        store.dispatch({
          type: 'WEB_CHAT/SET_NOTIFICATION',
          payload: {
            id: 'privacypolicy2',
            level: 'warn',
            message:
              'Aute proident tempor non aute duis adipisicing. Ad Lorem veniam cupidatat magna dolor officia id dolor in do velit elit nostrud anim. Voluptate magna ex consectetur commodo cupidatat voluptate ipsum velit quis Lorem et commodo quis quis.',
            persistent: false
          }
        });

        store.dispatch({
          type: 'WEB_CHAT/SET_NOTIFICATION',
          payload: {
            id: 'success',
            level: 'success',
            message: 'You have successfully completed something'
          }
        });

        setTimeout(() => {
          store.dispatch({
            type: 'WEB_CHAT/SET_NOTIFICATION',
            payload: {
              expireAt: 0,
              id: 'connectivity',
              message: 'Connected',
              persistent: true
            }
          });
        }, 1000);

        document.querySelector('#webchat > *').focus();
      })().catch(err => console.error(err));
    </script>
  </body>
</html>
